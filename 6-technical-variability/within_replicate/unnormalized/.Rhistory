guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "Histone Peptide Ratio CV", fill = "Replicate") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
# Chunk 23
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/normalized")
# merge with meta data
df <- assay(obj.filter.ratio, "MS2.ratio") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter.ratio)), by.x = "variable", by.y = "row.names")
# get CV for each ptm, replicate, standard amount
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(CV = sd(value, na.rm = TRUE)/mean(value, na.rm = TRUE))
write.csv(df.cv, "MS2_CV.csv", row.names = FALSE)
# plot by replicate, standard amount
pdf("MS2_CV_replicate.pdf",
width = 7,
height = 5)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_boxplot(width = 0.5, position = position_dodge(width = 0.6)) +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "MS2 peptide ratio CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot by replicate, standard amount, ptm
pdf("MS2_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "MS2 peptide ratio CV", fill = "Replicate") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
# Chunk 24
dir.create("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/across_replicate/normalized")
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/across_replicate/normalized")
# merge with meta data
df <- assay(obj.filter.ratio, "MS1.ratio") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter.ratio)), by.x = "variable", by.y = "row.names")
# summarize for each ptm in each replicate
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(mean = mean(value, na.rm = TRUE)) %>%
group_by(ptm, multiplier) %>%
summarize(CV = sd(mean, na.rm = TRUE)/mean(mean, na.rm = TRUE))
write.csv(df.cv, "MS1_CV.csv", row.names = FALSE)
# plot by standard amount
pdf("MS1_CV_replicate.pdf",
width = 4,
height = 4)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_boxplot() +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "Histone Peptide Ratio CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot by standard amount, ptm
pdf("MS1_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "Histone Peptide Ratio CV") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
# Chunk 25
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/across_replicate/normalized")
# merge with meta data
df <- assay(obj.filter.ratio, "MS2.ratio") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter.ratio)), by.x = "variable", by.y = "row.names")
# summarize for each ptm in each replicate
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(mean = mean(value, na.rm = TRUE)) %>%
group_by(ptm, multiplier) %>%
summarize(CV = sd(mean, na.rm = TRUE)/mean(mean, na.rm = TRUE))
write.csv(df.cv, "MS2_CV.csv", row.names = FALSE)
# plot by standard amount
pdf("MS2_CV_replicate.pdf",
width = 4,
height = 4)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_boxplot() +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "MS2 peptide ratio CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot by standard amount, ptm
pdf("MS2_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "MS2 peptide ratio CV") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
dir.create("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/normalized")
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/normalized")
# merge with meta data
df <- assay(obj.filter.ratio, "MS1.ratio") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter.ratio)), by.x = "variable", by.y = "row.names")
# get CV for each ptm, replicate, standard amount
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(CV = sd(value, na.rm = TRUE)/mean(value, na.rm = TRUE))
write.csv(df.cv, "MS1_CV.csv", row.names = FALSE)
pdf("MS1_CV_replicate.pdf",
width = 6,
height = 5)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_boxplot(width = 0.5, position = position_dodge(width = 0.6)) +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "Histone Peptide Ratio CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
pdf("MS1_CV_replicate.pdf",
width = 5,
height = 5)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_boxplot(width = 0.5, position = position_dodge(width = 0.6)) +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "Histone Peptide Ratio CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# Chunk 18
dir.create("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/unnormalized")
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/unnormalized")
# merge with meta data
df <- assay(obj.filter, "MS1") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter)), by.x = "variable", by.y = "row.names")
# get CV for each ptm, replicate, standard amount
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(CV = sd(value, na.rm = TRUE)/mean(value, na.rm = TRUE))
write.csv(df.cv, "MS1_CV.csv", row.names = FALSE)
# plot by replicate, standard amount
pdf("MS1_CV_replicate.pdf",
width = 5,
height = 5)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_boxplot(width = 0.5, position = position_dodge(width = 0.6)) +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "Histone Peptide Ratio CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot byreplicate, standard amount, ptm
pdf("MS1_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "MS1 instensity CV", fill = "Replicate") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
# Chunk 19
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/unnormalized")
# merge with meta data
df <- assay(obj.filter, "MS2") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter)), by.x = "variable", by.y = "row.names")
# get CV for each ptm, replicate, standard amount
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(CV = sd(value, na.rm = TRUE)/mean(value, na.rm = TRUE))
write.csv(df.cv, "MS2_CV.csv", row.names = FALSE)
# plot by replicate, standard amount
pdf("MS2_CV_replicate.pdf",
width = 7,
height = 5)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_boxplot(width = 0.5, position = position_dodge(width = 0.6)) +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "MS2 instensity CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot by replicate, standard amount, ptm
pdf("MS2_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "MS2 intensity CV", fill = "Replicate") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
# Chunk 20
dir.create("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/across_replicate/unnormalized")
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/across_replicate/unnormalized")
# merge with meta data
df <- assay(obj.filter, "MS1") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter)), by.x = "variable", by.y = "row.names")
# summarize for each ptm in each replicate
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(mean = mean(value, na.rm = TRUE)) %>%
group_by(ptm, multiplier) %>%
summarize(CV = sd(mean, na.rm = TRUE)/mean(mean, na.rm = TRUE))
write.csv(df.cv, "MS1_CV.csv", row.names = FALSE)
# plot by standard amount
pdf("MS1_CV_replicate.pdf",
width = 5,
height = 5)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_boxplot() +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "MS1 instensity CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot by standard amount, ptm
pdf("MS1_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "MS1 intensity CV") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
# Chunk 21
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/across_replicate/unnormalized")
# merge with meta data
df <- assay(obj.filter, "MS2") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter)), by.x = "variable", by.y = "row.names")
# summarize for each ptm in each replicate
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(mean = mean(value, na.rm = TRUE)) %>%
group_by(ptm, multiplier) %>%
summarize(CV = sd(mean, na.rm = TRUE)/mean(mean, na.rm = TRUE))
write.csv(df.cv, "MS2_CV.csv", row.names = FALSE)
# plot by standard amount
pdf("MS2_CV_replicate.pdf",
width = 4,
height = 4)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_boxplot() +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "MS2 instensity CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot by standard amount, ptm
pdf("MS2_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "MS2 intensity CV") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
# Chunk 22
dir.create("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/normalized")
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/normalized")
# merge with meta data
df <- assay(obj.filter.ratio, "MS1.ratio") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter.ratio)), by.x = "variable", by.y = "row.names")
# get CV for each ptm, replicate, standard amount
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(CV = sd(value, na.rm = TRUE)/mean(value, na.rm = TRUE))
write.csv(df.cv, "MS1_CV.csv", row.names = FALSE)
# plot by replicate, standard amount
pdf("MS1_CV_replicate.pdf",
width = 5,
height = 5)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_boxplot(width = 0.5, position = position_dodge(width = 0.6)) +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "Histone Peptide Ratio CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot byreplicate, standard amount, ptm
pdf("MS1_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "Histone Peptide Ratio CV", fill = "Replicate") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
# Chunk 23
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/normalized")
# merge with meta data
df <- assay(obj.filter.ratio, "MS2.ratio") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter.ratio)), by.x = "variable", by.y = "row.names")
# get CV for each ptm, replicate, standard amount
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(CV = sd(value, na.rm = TRUE)/mean(value, na.rm = TRUE))
write.csv(df.cv, "MS2_CV.csv", row.names = FALSE)
# plot by replicate, standard amount
pdf("MS2_CV_replicate.pdf",
width = 7,
height = 5)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_boxplot(width = 0.5, position = position_dodge(width = 0.6)) +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "MS2 peptide ratio CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot by replicate, standard amount, ptm
pdf("MS2_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "MS2 peptide ratio CV", fill = "Replicate") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
# Chunk 24
dir.create("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/across_replicate/normalized")
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/across_replicate/normalized")
# merge with meta data
df <- assay(obj.filter.ratio, "MS1.ratio") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter.ratio)), by.x = "variable", by.y = "row.names")
# summarize for each ptm in each replicate
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(mean = mean(value, na.rm = TRUE)) %>%
group_by(ptm, multiplier) %>%
summarize(CV = sd(mean, na.rm = TRUE)/mean(mean, na.rm = TRUE))
write.csv(df.cv, "MS1_CV.csv", row.names = FALSE)
# plot by standard amount
pdf("MS1_CV_replicate.pdf",
width = 5,
height = 5)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_boxplot() +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "Histone Peptide Ratio CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot by standard amount, ptm
pdf("MS1_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "Histone Peptide Ratio CV") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
# Chunk 25
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/across_replicate/normalized")
# merge with meta data
df <- assay(obj.filter.ratio, "MS2.ratio") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter.ratio)), by.x = "variable", by.y = "row.names")
# summarize for each ptm in each replicate
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(mean = mean(value, na.rm = TRUE)) %>%
group_by(ptm, multiplier) %>%
summarize(CV = sd(mean, na.rm = TRUE)/mean(mean, na.rm = TRUE))
write.csv(df.cv, "MS2_CV.csv", row.names = FALSE)
# plot by standard amount
pdf("MS2_CV_replicate.pdf",
width = 4,
height = 4)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_boxplot() +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "MS2 peptide ratio CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot by standard amount, ptm
pdf("MS2_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "MS2 peptide ratio CV") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
dir.create("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/unnormalized")
setwd("/Users/ronaldcutler/Dropbox\ (EinsteinMed)/Sidoli-lab/Projects/Single-cell-histone/Analysis/6-technical-variability/auto/within_replicate/unnormalized")
# merge with meta data
df <- assay(obj.filter, "MS1") %>%
rownames_to_column("ptm") %>%
pivot_longer(
cols = -ptm, # This keeps the 'id' column fixed
names_to = "variable",
values_to = "value") %>%
merge(as.data.frame(colData(obj.filter)), by.x = "variable", by.y = "row.names")
# get CV for each ptm, replicate, standard amount
df.cv <- df %>%
group_by(ptm, replicate, multiplier) %>%
summarize(CV = sd(value, na.rm = TRUE)/mean(value, na.rm = TRUE))
write.csv(df.cv, "MS1_CV.csv", row.names = FALSE)
# plot by replicate, standard amount
pdf("MS1_CV_replicate.pdf",
width = 5,
height = 5)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_boxplot(width = 0.5, position = position_dodge(width = 0.6)) +
theme_Publication() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = c(seq(0, 1.5, by = 0.25))) +
labs(title = "", x = "Histone Standard (pg)", y = "MS1 instensity CV", fill = "Replicate") +
scale_x_discrete(labels = c("10", "20", "40", "80"))
dev.off()
# plot byreplicate, standard amount, ptm
pdf("MS1_CV_ptm.pdf",
width = 25,
height = 25)
ggplot(subset(df.cv, multiplier %in% c(1,2,4,8)), aes(x = as.factor(multiplier), y = CV, fill = as.factor(replicate))) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_Publication(base_size = 12) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
labs(title = "", x = "Histone Standard (pg*10)", y = "MS1 instensity CV", fill = "Replicate") +
facet_wrap(.~ptm, scales = "free", labeller = labeller(ptm = label_wrap_gen(20)))
dev.off()
